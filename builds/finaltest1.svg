<svg id="svg8" width="210mm" height="297mm" version="1.1" viewBox="0 0 210 297" xmlns="http://www.w3.org/2000/svg">
  <style>
/*
 * welcome to the messiest css code ever
 * what the hell are you doing here lol
 */

body {
    margin: 0;
    padding: 0;

    background-color: #eee;
    filter: drop-shadow(5px 5px 0px #11111122);
}

.heater {
    transition: fill 5s ease-in-out;
}

#cube {
    transition: tranform 1s ease-in-out;
    transform-origin: 0px 75px;
    transform: scaleY(0);
}

@keyframes conveyorBeltMove {
    0% {
        stroke-dashoffset: 999;
    }
    100% {
        stroke-dashoffset: 20;
    }
}

#conveyorBelt {
    animation: conveyorBeltMove 25s linear infinite;
}

@keyframes createCube {
    0% {
        transform: scaleY(0);
    }

    100% {
        transform: scaleY(1);
    }
}

@keyframes fallCube {
    0% {
        transform: scaleY(1) translateY(0%);
    }
    100% {
        transform: scaleY(1) translateY(16.9%);
    }
}

@keyframes cubeBeltMove {
    0% {
        transform: scaleY(1) translateY(16.9%) translateX(0%);
    }
    100% {
        transform: scaleY(1) translateY(16.9%) translateX(37.5%);
    }
}

@keyframes cubePistonMoveUp {
    0% {
        transform: scaleY(1) translateY(15.9%) translateX(37.5%);
    }
    100% {
        transform: scaleY(1) translateY(6%) translateX(37.5%);
    }
}

@keyframes cubePistonMoveForward {
    0% {
        transform: scaleY(1) translateY(6%) translateX(37.5%);
    }
    100% {
        transform: scaleY(1) translateY(6%) translateX(67%);
    }
}

@keyframes cubeChangeColour {
    0% {
        fill: #bdbdbd;
    }
    100% {
        fill: #f44336;
    }
}

@keyframes cubePistonFall {
    0% {
        transform: scaleY(1) translateY(6%) translateX(67%);
    }
    100% {
        transform: scaleY(1) translateY(56%) translateX(67%);
    }
}

.cube--anim--create {
    animation: createCube 2s linear forwards;
}

.cube--anim--fall {
    animation: fallCube 1s ease-in forwards, cubeBeltMove 2.15s linear 1s forwards, cubePistonMoveUp 1s linear 3.15s forwards, cubeChangeColour 1s ease-out 4s forwards, cubePistonMoveForward 1s linear 5s forwards, cubePistonFall 1s ease-in 6s forwards;
}

@keyframes sprayAppear {
    0% {
        opacity: 0;
    }
    100% {
        opacity: .1;
    }
}

#spray {
    opacity: 0;
    animation: sprayAppear 2s ease-out 6s alternate-reverse forwards;
}

@keyframes sprayToolReveal {
    0% {
        transform: translateY(-7%);
    }
    100% {
        transform: translateY(0%);
    }
}

@keyframes sprayToolHeadMove {
    0% {
        transform: rotate(180deg);
    }
    100% {
        transform: rotate(-60deg);
    }
}

#sprayToolGroup {
    transform: translateY(-7%);
    animation: sprayToolReveal 1s ease-out 4s forwards;
}

#sprayToolHead {
    transform: rotate(180deg);
    transform-origin: 89.128px 81.733px;
    animation: sprayToolHeadMove 1s ease-out 4s forwards;
}

@keyframes epic {
    0% {
        transform: rotate(0deg);
    }
    100% {
        transform: rotate(360deg);
    }
}

#armLower, #armGrabber {
    transform: rotate(0deg);
    transform-origin: 112.85px 52px;
}

#armHigher {
    
}

@keyframes pistonMoveUp {
    0% {
        transfrom: translateY(0%);
    }
    100% {
        transform: translateY(-11%);
    }
}

#piston, #pistonTip {
    animation: pistonMoveUp 1s linear 5.15s forwards;
}

@keyframes pistonMoveForward {
    0% {
        transfrom: translateX(0%);
    }
    100% {
        transform: translateX(30%);
    }
}

#pistonParentGroup {
    animation: pistonMoveForward 1s linear 7s forwards;
}

@keyframes pistonBeltMove {
    0% {
        stroke-dashoffset: 70;
    }
    100% {
        stroke-dashoffset: 20;
    }
}

#pistonBelt {
    animation: pistonBeltMove 1s linear 7s forwards;
}

  </style>

  <rect id="rect1491" y="21.05" width="210" height="4.3501" style="fill-opacity:.9875;fill:#e0e0e0;paint-order:normal"/>
  <path id="path1495" d="m0 23.225h210" style="fill-opacity:.9875;fill:#616161;paint-order:normal;stroke:#9e9e9e"/>
  <path id="pistonBelt" d="m0 23.225h210" style="fill-opacity:.9875;fill:#212121;paint-order:normal;stroke-dasharray:6.00000018, 2.00000006000000008;stroke-dashoffset:20;stroke-width:2;stroke:#757575"/>
  <g id="pistonParentGroup">
    <g id="pistonGroup" transform="translate(-46.182 30.692)">
      <rect id="piston" x="159.73" y="31.221" width="3.8624" height="38.373" style="fill-opacity:.98824;fill:#bdbdbd;paint-order:normal;stroke-width:.62836"/>
      <rect id="pistonTip" x="156.03" y="68.01" width="11.269" height="1.5838" style="fill-opacity:.98824;fill:#757575;paint-order:normal;stroke-width:.21805"/>
    </g>
    <g id="g1520">
      <rect id="rect36921" x="111.88" y="25.4" width="7.2054" height="38.373" style="fill-opacity:.98824;fill:#757575;paint-order:normal;stroke-width:.85824"/>
      <path id="path1493" d="m111.88 25.4 2.1167-4.3501h2.9721l2.1167 4.3501v0.98551l-7.2054 0.07201z" style="fill-opacity:.99574;fill:#616161;paint-order:normal"/>
    </g>
  </g>

  <rect id="rect36870" x="25.509" y="129.17" width="97.367" height="5.9868" style="fill-opacity:.9875;fill:#e0e0e0;paint-order:normal"/>
  <rect id="cube" x="24.337" y="49.872" width="25.316" height="25.316" style="fill-opacity:.99792;fill:#bdbdbd;paint-order:normal"/>
  <g id="g34134" transform="matrix(.49051 0 0 .49051 -15.12 -6.2801)">
    <path id="rect824" d="m80.686 179.07h51.123v22.54h-51.123z" style="fill-opacity:.97917;fill:#212121;paint-order:normal"/>
    <path id="rect33997" transform="scale(.26458)" d="m233.96 362.6v335.2h335.2v-335.2l-226.55 20.99v49.076h156.49v195.07h-195.07v-244.15z" style="fill-opacity:.97917;fill:#212121;paint-order:normal"/>
    <path id="rect815" transform="scale(.26458)" d="m233.96 362.6v335.2h335.2v-335.2h-226.55v20.99h205.57v293.22h-293.22v-293.22h49.076v-20.99z" style="fill-opacity:.99792;fill:#121212;paint-order:normal"/>
    <path id="rect826" d="m80.686 201.61h51.123l10.583 12.25h-72.289z" style="fill-opacity:.97917;fill:#151515;paint-order:normal"/>
    <rect id="rect829" x="80.686" y="193.12" width="51.123" height="8.4932" style="fill-opacity:.97917;fill:#f9a825;paint-order:normal"/>
    <path id="path831" d="m106.25 194.47 3.4386 5.9559h-6.8772l1.7193-2.9779z" style="fill:none;paint-order:normal;stroke:#000"/>
    <g id="g839" transform="translate(.051426 .44166)">
      <path id="path833" d="m106.2 196.54v1.7757" style="fill:none;paint-order:normal;stroke-width:.5;stroke:#000"/>
      <path id="path835" d="m106.2 198.6v0.49084" style="fill:none;paint-order:normal;stroke-width:.5;stroke:#000"/>
    </g>
    <path id="path34015" transform="scale(.26458)" d="m283.04 48.391v335.2h20.988v-335.2zm59.57 0v335.2h20.988v-335.2z" style="fill-opacity:.99792;fill:#121212;paint-order:normal"/>
    <path id="heater1" class="heater" d="m67.456 108.41v63.743h12.985v-63.743z" style="fill-opacity:.99792;fill:#616161;paint-order:normal"/>
    <path id="heater2" class="heater" d="m132.05 108.41v63.743h12.985v-63.743z" style="fill-opacity:.99792;fill:#616161;paint-order:normal"/>
  </g>
  <circle id="path34024" cx="26.858" cy="9.7441" r="1.9568" style="fill:#bdbdbd;paint-order:normal"/>
  <path id="circle36858" d="m128.81 132.16c0 3.0124-2.442 5.4544-5.4544 5.4544h-98.557c-3.0124 0-5.4544-2.442-5.4544-5.4544 2e-6 -3.0124 2.442-5.4544 5.4544-5.4544l98.557 1e-5c3.0124 0 5.4544 2.442 5.4544 5.4544z" style="fill:none;paint-order:normal;stroke:#000"/>
  <path id="conveyorBelt" d="m128.81 132.16c0 3.0124-2.442 5.4544-5.4544 5.4544h-98.557c-3.0124 0-5.4544-2.442-5.4544-5.4544 2e-6 -3.0124 2.442-5.4544 5.4544-5.4544l98.557 1e-5c3.0124 0 5.4544 2.442 5.4544 5.4544z" style="fill:none;paint-order:normal;stroke-dasharray:6.00000018,2.00000006;stroke-dashoffset:20;stroke-width:2;stroke:#000"/>
  <circle id="path36866" cx="25.509" cy="132.16" r="2.9934" style="fill-opacity:.9875;fill:#757575;paint-order:normal;stroke-dashoffset:75.591;stroke-width:2;stroke:#616161"/>
  <circle id="circle36868" cx="122.88" cy="132.16" r="2.9934" style="fill-opacity:.9875;fill:#757575;paint-order:normal;stroke-dashoffset:75.591;stroke-width:2;stroke:#616161"/>
  <rect id="rect36874" x="68.358" y="-7.27e-15" width="5.2762" height="31.151" style="fill-opacity:.9875;fill:#b71c1c;paint-order:normal"/>
  <rect id="rect36876" x="75.221" y="-1.0058e-14" width="5.2762" height="31.151" style="fill-opacity:.9875;fill:#2e7d32;paint-order:normal"/>
  <rect id="rect36878" x="82.085" y="-5.843e-15" width="5.2762" height="31.151" style="fill-opacity:.9875;fill:#303f9f;paint-order:normal"/>
  <g id="g36950" transform="translate(-4.7625 -9.5415)">
    <g id="sprayToolGroup">
      <rect id="sprayToolAttachment" x="86.462" y="64.068" width="5.332" height="20.664" style="fill-opacity:.98824;fill:#757575;paint-order:normal;str                                                                                                               oke-width:1.5;stroke-dashoffset:75.591;stroke:#939393"/>
      <path id="spray" transform="rotate(-63.718 89.128 81.733)" d="m89.102 92.66 4.802 11.258h-9.604z" style="fill-opacity:.98824;fill:#b71c1c;paint-order:normal"/>
      <circle id="path36904" transform="rotate(-63.718 89.128 81.733)" cx="89.128" cy="81.733" r="4.6506" style="fill-opacity:.98824;fill:#757575;paint-order:normal;stroke-dashoffset:75.591;stroke-width:1.5624;stroke:#939393"/>
      <path id="sprayToolHead" transform="rotate(-63.718 89.128 81.733)" d="m89.128 97.641-4.802-11.258h9.604z" style="fill-opacity:.98824;fill:#757575;paint-order:normal;stroke-dashoffset:75.591;stroke-width:1.2348;stroke:#939393"/>
      <circle id="path36919" cx="89.128" cy="81.733" r="2.1539" style="fill-opacity:.98824;fill:#c62828;paint-order:normal"/>
    </g>
    <rect id="rect36872" x="74.62" y="42.192" width="29.015" height="27.876" style="fill-opacity:.9875;fill:#212121;paint-order:normal;stroke-dashoffset:75.591;stroke-width:3;stroke:#000"/>
    <g id="g36900" transform="translate(.64843 .10057)">
      <path id="path36880" d="m80.542 47.237v17.586" style="fill-opacity:.9875;fill:#eee;paint-order:normal;stroke-dashoffset:75.591;stroke-width:2;stroke:#eee"/>
      <path id="path36882" d="m88.479 47.237v17.586" style="fill-opacity:.9875;fill:#eee;paint-order:normal;stroke-dashoffset:75.591;stroke-width:2;stroke:#eee"/>
      <path id="path36884" d="m96.417 47.237v17.586" style="fill-opacity:.9875;fill:#eee;paint-order:normal;stroke-dashoffset:75.591;stroke-width:2;stroke:#eee"/>
      <circle id="path36888" cx="80.542" cy="55.385" r="1.9964" style="fill-opacity:.9875;fill:#b71c1c;paint-order:normal"/>
      <circle id="circle36890" cx="88.479" cy="60.808" r="1.9964" style="fill-opacity:.98824;fill:#2e7c32;paint-order:normal"/>
      <circle id="circle36892" cx="96.417" cy="52.408" r="1.9964" style="fill-opacity:.98824;fill:#303f9f;paint-order:normal"/>
    </g>
  </g>

  <script>

class CubeAnim {
  constructor(cubeEl, svgEl) {
    this.el = cubeEl;
    this.svg = svgEl;
    this.scaleY = 0;
    this.createAnimInterval = null;
    this.animationendCallback = null;
  }

  clearAnimClasses(el) {
    for (let animclass of el.srcElement.classList) {
      if (animclass.startsWith("cube--anim")) {
        el.classList.remove(animclass);
      }
    }
  }

  init() {
    this.el.addEventListener(
      "animationend",
      function(event) {
        this.animationendCallback();
      }.bind(this)
    );

    this.createAnim();
  }

  duplicate() {
    let clone = this.el.cloneNode(true);
    //this.clearAnimClasses(clone);
    this.svg.appendChild(clone);
  }

  cubeFallAnim() {
    this.el.classList.add("cube--anim--fall");
  }

  createAnim() {
    this.el.classList.add("cube--anim--create");
    this.animationendCallback = this.cubeFallAnim;
  }
}

function getEl(query, all = true) {
  let el = null;

  if (all) {
    el = document.querySelectorAll(query);
  } else {
    el = document.querySelector(query);
  }

  if (!el) {
    console.error(query + " can't be found - svg loading error");
    return null;
  }

  return el;
}

document.addEventListener("DOMContentLoaded", function(event) {
  let heaters = getEl(".heater");
  let cubeEl = getEl("#cube", false);
  let svgEl = getEl("svg", false);

  /* -- cube animation -- */
  let cubeAnim = new CubeAnim(cubeEl, svgEl);

  for (let heater of heaters) {
    heater.style.fill = "rgb(183,28,28)";
  }

  cubeAnim.init();
});

  </script>
</svg>
